%% This file tests the dam static size sensitivity for RCP4.5 and RCP8.5
% December 17, 2020

% load data
close all
clear all

% load RCP4.5 results- different dam sizes- all RCP45, 3% discount
addpath('/Users/jenniferskerker/Documents/GradSchool/Research/Project1/Code/Models/Mombasa_climate/SDP/Dam Sensitivity');

% try loading results dynamically
data_RCP45 = {'results_RCP45_stor60_13_Dec_2020_18_38_36.mat', ...
    'results_RCP45_stor65_13_Dec_2020_19_50_20.mat',...
    'results_RCP45_stor70_13_Dec_2020_20_06_23.mat',...
    'results_RCP45_stor75_13_Dec_2020_20_19_32.mat',...
    'results_RCP45_stor80_13_Dec_2020_20_31_02.mat',...
    'results_RCP45_stor85_13_Dec_2020_20_40_27.mat',...
    'results_RCP45_stor90_13_Dec_2020_20_52_37.mat',...
    'results_RCP45_stor95_13_Dec_2020_21_05_17.mat',...
    'results_RCP45_stor100_13_Dec_2020_21_19_29.mat'};

% initialize variables for loading data
C_all_RCP45 = zeros(10000, 5, 4, 9);
X_all_RCP45 = zeros(151, 32, 4, 5, 9);
totalCost_all_RCP45 = zeros(10000,3,9);

% load data
for j=1:9
    load(data_RCP45{j});
    C_all_RCP45(:,:,:,j) = C_state;
    X_all_RCP45(:,:,:,:,j) = X;
    totalCost_all_RCP45(:,:,j) = squeeze(sum(totalCostTime(:,:,1:3), 2));
end

% create distribution for 4 capacity states over 5 time periods
s_C_bins = s_C - 0.01;
s_C_bins(5) = s_C(end)+0.01;

% get counts for plot of C state
for k=1:5
    for j=1:9
        C_counts_RCP45(k, :, j) = histcounts(C_all_RCP45(:,k,4,j), s_C_bins);
    end
end

% load RCP8.5 results- different dam sizes- all RCP85, 3% discount
addpath('/Users/jenniferskerker/Documents/GradSchool/Research/Project1/Code/Models/Fletcher_2019_Learning_Climate/SDP/Dam Sensitivity');

% try loading results dynamically
data_RCP85 = {'results_RCP85_stor60_17_Dec_2020_15_08_34.mat', ...
    'results_RCP85_stor65_17_Dec_2020_15_19_20.mat',...
    'results_RCP85_stor70_17_Dec_2020_15_26_44.mat',...
    'results_RCP85_stor75_17_Dec_2020_15_34_21.mat',...
    'results_RCP85_stor80_17_Dec_2020_15_44_40.mat',...
    'results_RCP85_stor85_17_Dec_2020_15_57_01.mat',...
    'results_RCP85_stor90_17_Dec_2020_16_10_44.mat',...
    'results_RCP85_stor95_17_Dec_2020_16_24_00.mat',...
    'results_RCP85_stor100_17_Dec_2020_16_36_31.mat'};

% initialize variables for loading data
C_all_RCP85 = zeros(10000, 5, 4, 9);
X_all_RCP85 = zeros(151, 32, 4, 5, 9);
totalCost_all_RCP85 = zeros(10000,3,9);

% load data
for j=1:9
    load(data_RCP85{j});
    C_all_RCP85(:,:,:,j) = C_state;
    X_all_RCP85(:,:,:,:,j) = X;
    totalCost_all_RCP85(:,:,j) = squeeze(sum(totalCostTime(:,:,1:3), 2));
end

% get counts for plot of C state
for k=1:5
    for j=1:9
        C_counts_RCP85(k, :, j) = histcounts(C_all_RCP85(:,k,4,j), s_C_bins);
    end
end


% set other variables
C = {[0.6350, 0.0780, 0.1840], [0.8500, 0.3250, 0.0980], [0.4660, 0.6740, 0.1880],...
    [0, 0.4470, 0.7410], [0.4940, 0.1840, 0.5560]};
sizes = 60:5:100;
scen = strcat(string(sizes));
years = {'2000', '2020', '2040', '2060', '2080'};
cap = {'Small', 'Large', 'Flex', 'Flex-exp'};
dams = 60:5:100;

%% figure comparing capacity states in each time period

f = figure('Position', [217 63 943 635]);
for j = 1:9
    subplot(3,3,j)
    bar(C_counts_RCP45(:,:,j))
    xticklabels(years);
    ylabel('Count');
    if j==9
        legend(cap, 'location', 'southwest');
    end
    title(strcat('Small Dam:', {' '}, scen{j}, ' MCM'));
end
sgtitle('Capacity States for Various Dam Sizes (Large = Small + 40 MCM) for RCP4.5, 3% Discount');

f = figure('Position', [217 63 943 635]);
for j = 1:9
    subplot(3,3,j)
    bar(C_counts_RCP85(:,:,j))
    xticklabels(years);
    ylabel('Count');
    if j==9
        legend(cap, 'location', 'southwest');
    end
    title(strcat('Small Dam:', {' '}, scen{j}, ' MCM'));
end
sgtitle('Capacity States for Various Dam Sizes (Large = Small + 40 MCM) for RCP8.5, 3% Discount');

%% Analyze static dam costs
% Create a table of median, mean, 10%, and 90% quantile data and creat a
% boxplot with data for the small dam

% Calc median, mean, 10%, 90% quantiles for RCP45
Cost_med_RCP45 = squeeze(median(totalCost_all_RCP45(:,1:2,1:9)));
Cost_mean_RCP45 = squeeze(mean(totalCost_all_RCP45(:,1:2,1:9)));
Cost_p_RCP45 = squeeze(prctile(totalCost_all_RCP45(:,1,1:9),[10 50 90]));
Cost_90p_RCP45 = squeeze(prctile(totalCost_all_RCP45(:,1:2,1:9),.9));

% Calc median, mean, 10%, 90% quantiles for RCP85
Cost_med_RCP85 = squeeze(median(totalCost_all_RCP85(:,1:2,1:9)));
Cost_mean_RCP85 = squeeze(mean(totalCost_all_RCP85(:,1:2,1:9)));
Cost_10p_RCP85 = squeeze(prctile(totalCost_all_RCP85(:,1:2,1:9),.1));
Cost_90p_RCP85 = squeeze(prctile(totalCost_all_RCP85(:,1:2,1:9),.9));

f = figure;
pos_1 = 1:1:9;
b1 = boxplot(squeeze(totalCost_all_RCP45(:,1,:)), 'color', 'r', 'position', ...
    pos_1, 'width', 0.3);
hold on
pos_2 = 1.4:1:9.4;
b2 = boxplot(squeeze(totalCost_all_RCP85(:,1,:)), 'color', 'b', 'position',...
    pos_2, 'width', 0.3, 'Symbol', 'b+');
xlim([0.75, 10]);
d = string(dams);
ax=gca;
ax.XTick = ax.XTick - 0.2;
ax.XLim = ax.XLim - 0.2;
xticklabels(d);
xlabel('Dam Size (MCM)');
ylabel('Cost (M$)');
legend([b1(4,1), b2(4,1)], {'RCP4.5', 'RCP8.5'}, 'Location', 'northwest');
sgtitle('Static Dam Costs for RCP4.5 and RCP8.5');


%% Regret plot precip: Fig 6 in paper- dam and shortage costs with Precip
% looking at various dam sizes for RCP4.5
addpath('/Volumes/Ultra Touch/FlexDamProject/Results/RCP85 Static Dam Sensitivity');
addpath('/Users/jenniferskerker/Documents/GradSchool/Research/Project1/Code/Models/Fletcher_2019_Learning_Climate/Plots/JSPlots');
f = figure('Position', [14 122 830 548]);

%RCP4.5, Small Dam: 80 MCM
load('results_RCP85_stor80_17_Dec_2020_15_44_40.mat')
% Regret for last time period
bestOption = 0;

P_regret = [68 73 78 83 88];
damCost = squeeze(sum(damCostTime(:,:,1:3), 2));
shortCost = squeeze(sum(shortageCostTime(:,:,1:3), 2));
totalCost = squeeze(sum(totalCostTime(:,:,1:3), 2));
meanCostPnow = zeros(length(P_regret),3);
grp = {68, 73, 78, 83, 88};
for i = 1:length(P_regret)
    % Find simulaitons with this level of precip
    ind_P = P_state(:,end) == P_regret(i);
    % Get average cost of each infra option in that P level
    damCostPnow = damCost(ind_P,:);
    damMeanCostPnow(i,:) = mean(damCostPnow,1);
    
    shortageCostPnow = shortCost(ind_P,:);
    shortMeanCostPnow(i,:) = mean(shortageCostPnow,1);
    
    totalCostPnow = totalCost(ind_P,:);
    meanCostPnow(i,:) = mean(totalCostPnow,1);
end

combined(:,:,1) = damMeanCostPnow/1E6;
combined(:,:,2) = shortMeanCostPnow/1E6;

bestInfraCost = min(meanCostPnow,[],2);
regret = meanCostPnow - repmat(bestInfraCost, 1,3);

subplot(2,2,2)
font_size = 12;
h = plotBarStackGroups(combined, grp);
hold on

 colors = {[250,128,114]/255,[154,205,50]/255,[135,206,235]/255,[178,34,34]/255,...
     [0,0.5,0], [0,0,0.5]}'; %or define your own color order; 1 for each m segments
set(h,{'FaceColor'},colors)

yl = ylabel('M$')
yl.Position = yl.Position - [ .2 0 0];
xl = xlabel('P in 2090 [mm/month]')
%xl.Position = xl.Position - [ 0 4 0];
ylim([0 150]);
sgtitle('Cost for Infrastructure Alternatives by 2090 Precip: RCP8.5, 3% Discount')
title('Small Dam: 80 MCM')

% % FONT
allaxes = findall(f, 'type', 'axes');
set(allaxes,'FontSize', font_size)
set(findall(allaxes,'type','text'),'FontSize', font_size)
% %printsetup(f, 7, 5, 12, 1, 300, 1, 1, 'regret' )

%RCP4.5, Small Dam: 75 MCM
load('results_RCP85_stor75_17_Dec_2020_15_34_21.mat');
% Regret for last time period
bestOption = 0;

P_regret = [68 73 78 83 88];
damCost = squeeze(sum(damCostTime(:,:,1:3), 2));
shortCost = squeeze(sum(shortageCostTime(:,:,1:3), 2));
totalCost = squeeze(sum(totalCostTime(:,:,1:3), 2));
meanCostPnow = zeros(length(P_regret),3);
grp = {68, 73, 78, 83, 88};
for i = 1:length(P_regret)
    % Find simulaitons with this level of precip
    ind_P = P_state(:,end) == P_regret(i);
    % Get average cost of each infra option in that P level
    damCostPnow = damCost(ind_P,:);
    damMeanCostPnow(i,:) = mean(damCostPnow,1);
    
    shortageCostPnow = shortCost(ind_P,:);
    shortMeanCostPnow(i,:) = mean(shortageCostPnow,1);
    
    totalCostPnow = totalCost(ind_P,:);
    meanCostPnow(i,:) = mean(totalCostPnow,1);
end

combined(:,:,1) = damMeanCostPnow/1E6;
combined(:,:,2) = shortMeanCostPnow/1E6;

bestInfraCost = min(meanCostPnow,[],2);
regret = meanCostPnow - repmat(bestInfraCost, 1,3);

subplot(2,2,1)
font_size = 12;
h = plotBarStackGroups(combined, grp);
hold on

set(h,{'FaceColor'},colors)
yl = ylabel('M$')
yl.Position = yl.Position - [ .2 0 0];
xl = xlabel('P in 2090 [mm/month]')
%xl.Position = xl.Position - [ 0 4 0];
ylim([0 150]);
title('Small Dam: 75 MCM')

% FONT
allaxes = findall(f, 'type', 'axes');
set(allaxes,'FontSize', font_size)
set(findall(allaxes,'type','text'),'FontSize', font_size)
%printsetup(f, 7, 5, 12, 1, 300, 1, 1, 'regret' )

%RCP4.5, Small Dam: 85 MCM
load('results_RCP85_stor85_17_Dec_2020_15_57_01.mat');
% Regret for last time period
bestOption = 0;

P_regret = [68 73 78 83 88];
damCost = squeeze(sum(damCostTime(:,:,1:3), 2));
shortCost = squeeze(sum(shortageCostTime(:,:,1:3), 2));
totalCost = squeeze(sum(totalCostTime(:,:,1:3), 2));
meanCostPnow = zeros(length(P_regret),3);
grp = {68, 73, 78, 83, 88};
for i = 1:length(P_regret)
    % Find simulaitons with this level of precip
    ind_P = P_state(:,end) == P_regret(i);
    % Get average cost of each infra option in that P level
    damCostPnow = damCost(ind_P,:);
    damMeanCostPnow(i,:) = mean(damCostPnow,1);
    
    shortageCostPnow = shortCost(ind_P,:);
    shortMeanCostPnow(i,:) = mean(shortageCostPnow,1);
    
    totalCostPnow = totalCost(ind_P,:);
    meanCostPnow(i,:) = mean(totalCostPnow,1);
end

combined(:,:,1) = damMeanCostPnow/1E6;
combined(:,:,2) = shortMeanCostPnow/1E6;

bestInfraCost = min(meanCostPnow,[],2);
regret = meanCostPnow - repmat(bestInfraCost, 1,3);

subplot(2,2,3)
font_size = 12;
h = plotBarStackGroups(combined, grp);
hold on

set(h,{'FaceColor'},colors)
yl = ylabel('M$')
yl.Position = yl.Position - [ .2 0 0];
xl = xlabel('P in 2090 [mm/month]')
%xl.Position = xl.Position - [ 0 4 0];
ylim([0 150]);
title('Small Dam: 85 MCM')

% FONT
allaxes = findall(f, 'type', 'axes');
set(allaxes,'FontSize', font_size)
set(findall(allaxes,'type','text'),'FontSize', font_size)
%printsetup(f, 7, 5, 12, 1, 300, 1, 1, 'regret' )

%RCP4.5, Small Dam: 90 MCM
load(data_RCP85{7});
% Regret for last time period
bestOption = 0;

P_regret = [68 73 78 83 88];
damCost = squeeze(sum(damCostTime(:,:,1:3), 2));
shortCost = squeeze(sum(shortageCostTime(:,:,1:3), 2));
totalCost = squeeze(sum(totalCostTime(:,:,1:3), 2));
meanCostPnow = zeros(length(P_regret),3);
grp = {68, 73, 78, 83, 88};
for i = 1:length(P_regret)
    % Find simulaitons with this level of precip
    ind_P = P_state(:,end) == P_regret(i);
    % Get average cost of each infra option in that P level
    damCostPnow = damCost(ind_P,:);
    damMeanCostPnow(i,:) = mean(damCostPnow,1);
    
    shortageCostPnow = shortCost(ind_P,:);
    shortMeanCostPnow(i,:) = mean(shortageCostPnow,1);
    
    totalCostPnow = totalCost(ind_P,:);
    meanCostPnow(i,:) = mean(totalCostPnow,1);
end

combined(:,:,1) = damMeanCostPnow/1E6;
combined(:,:,2) = shortMeanCostPnow/1E6;

bestInfraCost = min(meanCostPnow,[],2);
regret = meanCostPnow - repmat(bestInfraCost, 1,3);

subplot(2,2,4)
font_size = 12;
h = plotBarStackGroups(combined, grp);
hold on

set(h,{'FaceColor'},colors)
yl = ylabel('M$')
yl.Position = yl.Position - [ .2 0 0];
xl = xlabel('P in 2090 [mm/month]')
%xl.Position = xl.Position - [ 0 4 0];
ylim([0 150]);
title('Small Dam: 90 MCM')

% % legend
l = legend('Flexible Dam', 'Flex Shortage', 'Large Dam', ...
      'Large Shortage', 'Small Dam', 'Small Shortage')
l.FontSize = 9;
legend('boxoff')

% FONT
allaxes = findall(f, 'type', 'axes');
set(allaxes,'FontSize', font_size)
set(findall(allaxes,'type','text'),'FontSize', font_size)
%printsetup(f, 7, 5, 12, 1, 300, 1, 1, 'regret' )

%% Flexible Dam Sizing Test using 12/19 Data- RCP8.5
% To get this data, I ran an optimization function, that crashed, but still
% got a decent amount of data- about 22 results files
clear all;
close all;

% load data from test using ga alg
addpath('/Volumes/Ultra Touch/FlexDamProject/Results/RCP85 Dam Sens Flex');

% dataFlex_RCP85 = {'results_RCP85_19_Dec_2020_17_41_48.mat',...
%     'results_RCP85_19_Dec_2020_17_58_04.mat',...
%     'results_RCP85_19_Dec_2020_18_21_00.mat',...
%     'results_RCP85_19_Dec_2020_18_43_22.mat',...
%     'results_RCP85_19_Dec_2020_19_04_34.mat',...
%     'results_RCP85_19_Dec_2020_19_25_44.mat',...
%     'results_RCP85_19_Dec_2020_19_46_05.mat',...
%     'results_RCP85_19_Dec_2020_19_59_57.mat',...
%     'results_RCP85_19_Dec_2020_20_14_03.mat',...
%     'results_RCP85_19_Dec_2020_20_31_43.mat',...
%     'results_RCP85_19_Dec_2020_20_49_24.mat',...
%     'results_RCP85_19_Dec_2020_21_07_10.mat',...
%     'results_RCP85_19_Dec_2020_21_24_33.mat',...
%     'results_RCP85_19_Dec_2020_21_48_07.mat',...
%     'results_RCP85_19_Dec_2020_22_10_41.mat',...
%     'results_RCP85_19_Dec_2020_22_28_52.mat',...
%     'results_RCP85_19_Dec_2020_22_43_15.mat',...
%     'results_RCP85_19_Dec_2020_22_57_07.mat',...
%     'results_RCP85_19_Dec_2020_23_12_18.mat',...
%     'results_RCP85_19_Dec_2020_23_31_03.mat',...
%     'results_RCP85_19_Dec_2020_23_49_40.mat',...
%     'results_RCP85_20_Dec_2020_00_03_48.mat'};

% load data from running all dam size combinations
addpath('/Volumes/Ultra Touch/FlexDamProject/Results/RCP85 Results-DamOpt-Jan1');

dataFlex_RCP85 = {'results_RCP85_02_Jan_2021_10_10_54.mat',...
    'results_RCP85_02_Jan_2021_10_23_35.mat',...
    'results_RCP85_02_Jan_2021_10_30_42.mat',...
    'results_RCP85_02_Jan_2021_10_36_00.mat',...
    'results_RCP85_02_Jan_2021_10_40_59.mat',...
    'results_RCP85_02_Jan_2021_10_46_39.mat',...
    'results_RCP85_02_Jan_2021_10_52_09.mat',...
    'results_RCP85_02_Jan_2021_10_57_41.mat',...
    'results_RCP85_02_Jan_2021_11_02_40.mat',...
    'results_RCP85_02_Jan_2021_11_07_38.mat',...
    'results_RCP85_02_Jan_2021_11_12_40.mat',...
    'results_RCP85_02_Jan_2021_11_17_36.mat',...
    'results_RCP85_02_Jan_2021_11_22_29.mat',...
    'results_RCP85_02_Jan_2021_11_27_26.mat',...
    'results_RCP85_02_Jan_2021_11_32_18.mat',...
    'results_RCP85_02_Jan_2021_11_37_16.mat',...
    'results_RCP85_02_Jan_2021_11_42_11.mat',...
    'results_RCP85_02_Jan_2021_11_47_09.mat',...
    'results_RCP85_02_Jan_2021_11_52_10.mat',...
    'results_RCP85_02_Jan_2021_11_57_09.mat',...
    'results_RCP85_02_Jan_2021_12_02_07.mat',...
    'results_RCP85_02_Jan_2021_12_07_01.mat',...
    'results_RCP85_02_Jan_2021_12_12_05.mat',...
    'results_RCP85_02_Jan_2021_12_17_01.mat',...
    'results_RCP85_02_Jan_2021_12_22_01.mat',...
    'results_RCP85_02_Jan_2021_12_26_58.mat',...
    'results_RCP85_02_Jan_2021_12_31_56.mat',...
    'results_RCP85_02_Jan_2021_12_36_50.mat',...
    'results_RCP85_02_Jan_2021_12_41_45.mat',...
    'results_RCP85_02_Jan_2021_12_46_42.mat',...
    'results_RCP85_02_Jan_2021_12_51_40.mat',...
    'results_RCP85_02_Jan_2021_12_56_39.mat',...
    'results_RCP85_02_Jan_2021_13_01_41.mat',...
    'results_RCP85_02_Jan_2021_13_06_32.mat',...
    'results_RCP85_02_Jan_2021_13_11_42.mat',...
    'results_RCP85_02_Jan_2021_13_17_18.mat',...
    'results_RCP85_02_Jan_2021_13_22_21.mat',...
    'results_RCP85_02_Jan_2021_13_27_10.mat',...
    'results_RCP85_02_Jan_2021_13_31_59.mat',...
    'results_RCP85_02_Jan_2021_13_36_42.mat',...
    'results_RCP85_02_Jan_2021_13_41_28.mat',...
    'results_RCP85_02_Jan_2021_13_46_15.mat',...
    'results_RCP85_02_Jan_2021_13_51_05.mat',...
    'results_RCP85_02_Jan_2021_13_55_53.mat',...
    'results_RCP85_02_Jan_2021_14_00_42.mat',...
    'results_RCP85_02_Jan_2021_14_05_29.mat',...
    'results_RCP85_02_Jan_2021_14_10_14.mat',...
    'results_RCP85_02_Jan_2021_14_15_00.mat',...
    'results_RCP85_02_Jan_2021_14_19_46.mat',...
    'results_RCP85_02_Jan_2021_14_24_31.mat',...
    'results_RCP85_12_Jan_2021_10_17_48.mat',...
    'results_RCP85_12_Jan_2021_10_25_12.mat',...
    'results_RCP85_12_Jan_2021_10_32_44.mat',...
    'results_RCP85_12_Jan_2021_10_40_54.mat',...
    'results_RCP85_12_Jan_2021_10_52_42.mat',...
    'results_RCP85_12_Jan_2021_11_01_02.mat',...
    'results_RCP85_12_Jan_2021_11_08_16.mat',...
    'results_RCP85_12_Jan_2021_11_15_15.mat',...
    'results_RCP85_12_Jan_2021_11_27_14.mat',... % took out a file here
    'results_RCP85_12_Jan_2021_11_41_32.mat',...
    'results_RCP85_12_Jan_2021_11_48_53.mat',...
    'results_RCP85_12_Jan_2021_11_57_54.mat',...
    'results_RCP85_12_Jan_2021_12_03_36.mat',...
    'results_RCP85_12_Jan_2021_12_09_07.mat',...
    'results_RCP85_12_Jan_2021_12_15_55.mat',...
    'results_RCP85_12_Jan_2021_12_21_53.mat',...
    'results_RCP85_12_Jan_2021_12_27_19.mat',... % took out 2 files here (where small dam > large dam)
    'results_RCP85_12_Jan_2021_12_52_00.mat',...
    'results_RCP85_12_Jan_2021_13_04_51.mat',...
    'results_RCP85_12_Jan_2021_13_14_14.mat',...
    'results_RCP85_12_Jan_2021_13_21_07.mat',...
    'results_RCP85_12_Jan_2021_13_27_32.mat',...
    'results_RCP85_12_Jan_2021_13_33_59.mat',...
    'results_RCP85_12_Jan_2021_13_40_11.mat'};
    
for g=1:length(dataFlex_RCP85)
    load(dataFlex_RCP85{g});
    storFlex(g,1) = storage(1);
    storFlex(g,2) = storage(2);
    totalCostFlex(:,:,g) = squeeze(sum(totalCostTime(:,:,1:3), 2));
    actionsFlex(:,:,g) = action(:,:,4);
    
end

for g=1:length(dataFlex_RCP85)
    medCostFlex(g) = median(sum(totalCostFlex(:,3,g), 2));
    meanCostFlex(g) = mean(sum(totalCostFlex(:,3,g), 2));
    perc75(g) = prctile(totalCostFlex(:,3,g),75);
    perc90(g) = prctile(totalCostFlex(:,3,g),90);
end

for g=1:length(dataFlex_RCP85)
    for i=1:5
        countFlex(g, :, i) = histcounts(actionsFlex(:,i,g), s_C_bins);
    %C_counts_med(i, :) = histcounts(action_med_75_115(:,i,4), s_C_bins);
    end 
end

comboFlex(:,1) = storFlex(:, 1);
comboFlex(:,2) = storFlex(:, 2);
comboFlex(:,3) = medCostFlex(:)';
comboFlex(:,4) = meanCostFlex(:)';
comboFlex(:,5) = perc75(:)';
comboFlex(:,6) = perc90(:)';
comboFlex(:,7:10) = countFlex(:,:,1);

%save('RCP85_results_Jan2021', 'medCostFlex', 'meanCostFlex', 'perc75', 'perc90', 'actionsFlex', 'storFlex', 'totalCostFlex', 'dataFlex_RCP85', 'comboFlex', 'countFlex', 's_C_bins')
%% plot flex data- RCP8.5

% create scatter with med and mean cost data
f = figure('Position', [57 254 1115 430]);
subplot(1,2,1)
scatter(comboFlex(:,1), comboFlex(:,2), [], comboFlex(:,3), 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
xticks([70:5:105]);
title('Median Dam Cost (M$)');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',comboFlex(:,3)/1000000))

subplot(1,2,2)
scatter(comboFlex(:,1), comboFlex(:,2), [], comboFlex(:,4), 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
xticks([70:5:105]);
%ylabel('Large Dam Size (MCM)');
title('Mean Dam Cost (M$)');
colormap(jet);
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',comboFlex(:,4)/1000000))
sgtitle('RCP8.5 Flexible Dam Median and Mean Costs');

%% %% Look at various percentiles- RCP8.5 flex

Cost_p_RCP85 = squeeze(prctile(totalCostFlex(:,3,:),[10 25 75 90]))';

%f = figure('Position', [57 254 1115 430]);
subplot(2,2,1)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP85(:,1)/1000000, 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
colormap(jet);
title('10th Percentile');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP85(:,1)/1000000))

subplot(2,2,2)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP85(:,2)/1000000, 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
%ylabel('Large Dam Size (MCM)');
title('25th Percentile');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP85(:,2)/1000000))

subplot(2,2,3)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP85(:,3)/1000000, 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
title('75th Percentile');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP85(:,3)/1000000))

subplot(2,2,4)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP85(:,4)/1000000, 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
%ylabel('Large Dam Size (MCM)');
title('90th Percentile');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP85(:,4)/1000000))
sgtitle('RCP8.5 Dam Costs (M$)');

%% %% Flexible Dam Sizing Test using 12/19 Data- RCP4.5
% To get this data, I ran an optimization function that ran overnight-- I
% ended up killing it to see what the data shows. I do not think it's
% working properly anyway.
clear all;
close all;

% load data
addpath('/Volumes/Ultra Touch/FlexDamProject/Results/RCP45 Dam Sens Flex');

% dataFlex_RCP45 = {'results_RCP45_20_Dec_2020_23_40_22.mat',...
%     'results_RCP45_20_Dec_2020_23_46_26.mat',...
%     'results_RCP45_20_Dec_2020_23_52_02.mat',...
%     'results_RCP45_20_Dec_2020_23_57_40.mat',...
%     'results_RCP45_21_Dec_2020_00_03_27.mat',...
%     'results_RCP45_21_Dec_2020_00_10_30.mat',...
%     'results_RCP45_21_Dec_2020_00_18_59.mat',...
%     'results_RCP45_21_Dec_2020_00_27_28.mat',...
%     'results_RCP45_21_Dec_2020_00_35_55.mat',...
%     'results_RCP45_21_Dec_2020_00_44_20.mat',...
%     'results_RCP45_21_Dec_2020_00_52_44.mat',...
%     'results_RCP45_21_Dec_2020_01_00_14.mat',...
%     'results_RCP45_21_Dec_2020_01_06_01.mat',...
%     'results_RCP45_21_Dec_2020_01_12_04.mat',...
%     'results_RCP45_21_Dec_2020_01_18_15.mat',...
%     'results_RCP45_21_Dec_2020_01_24_28.mat',...
%     'results_RCP45_21_Dec_2020_01_30_53.mat',...
%     'results_RCP45_21_Dec_2020_01_38_13.mat',...
%     'results_RCP45_21_Dec_2020_01_46_49.mat',...
%     'results_RCP45_21_Dec_2020_01_54_47.mat',...
%     'results_RCP45_21_Dec_2020_02_02_48.mat',...
%     'results_RCP45_21_Dec_2020_02_10_44.mat',...
%     'results_RCP45_21_Dec_2020_02_18_58.mat',...
%     'results_RCP45_21_Dec_2020_02_27_24.mat',...
%     'results_RCP45_21_Dec_2020_02_35_41.mat',...
%     'results_RCP45_21_Dec_2020_02_44_20.mat',...
%     'results_RCP45_21_Dec_2020_02_52_55.mat',...
%     'results_RCP45_21_Dec_2020_03_00_52.mat',...
%     'results_RCP45_21_Dec_2020_03_08_52.mat',...
%     'results_RCP45_21_Dec_2020_03_17_57.mat',...
%     'results_RCP45_21_Dec_2020_03_27_27.mat',...
%     'results_RCP45_21_Dec_2020_03_36_45.mat',...
%     'results_RCP45_21_Dec_2020_03_45_57.mat',...
%     'results_RCP45_21_Dec_2020_03_54_50.mat',...
%     'results_RCP45_21_Dec_2020_04_03_54.mat',...
%     'results_RCP45_21_Dec_2020_04_13_13.mat',...
%     'results_RCP45_21_Dec_2020_04_22_30.mat',...
%     'results_RCP45_21_Dec_2020_04_31_03.mat',...
%     'results_RCP45_21_Dec_2020_04_40_04.mat',...
%     'results_RCP45_21_Dec_2020_04_49_24.mat',...
%     'results_RCP45_21_Dec_2020_04_58_41.mat',...
%     'results_RCP45_21_Dec_2020_05_07_13.mat',...
%     'results_RCP45_21_Dec_2020_05_15_38.mat',...
%     'results_RCP45_21_Dec_2020_05_24_43.mat',...
%     'results_RCP45_21_Dec_2020_05_34_20.mat',...
%     'results_RCP45_21_Dec_2020_05_43_43.mat',...
%     'results_RCP45_21_Dec_2020_05_52_12.mat',...
%     'results_RCP45_21_Dec_2020_06_00_48.mat',...
%     'results_RCP45_21_Dec_2020_06_09_35.mat',...
%     'results_RCP45_21_Dec_2020_06_18_44.mat',...
%     'results_RCP45_21_Dec_2020_06_27_49.mat',...
%     'results_RCP45_21_Dec_2020_06_36_48.mat',...
%     'results_RCP45_21_Dec_2020_06_45_58.mat',...
%     'results_RCP45_21_Dec_2020_06_54_42.mat',...
%     'results_RCP45_21_Dec_2020_07_03_11.mat',...
%     'results_RCP45_21_Dec_2020_07_11_47.mat',...
%     'results_RCP45_21_Dec_2020_07_20_59.mat',...
%     'results_RCP45_21_Dec_2020_07_30_31.mat',...
%     'results_RCP45_21_Dec_2020_07_39_07.mat',...
%     'results_RCP45_21_Dec_2020_07_47_29.mat',...
%     'results_RCP45_21_Dec_2020_07_55_51.mat'};

% testing ga function again...
addpath('/Volumes/Ultra Touch/FlexDamProject/Results/RCP45-DamOpt-ga');
dataFlex_RCP45 = {'results_RCP45_12_Jan_2021_22_41_49.mat',...
    'results_RCP45_12_Jan_2021_22_48_13.mat',...
    'results_RCP45_12_Jan_2021_22_54_10.mat',...
    'results_RCP45_12_Jan_2021_23_00_14.mat',...
    'results_RCP45_12_Jan_2021_23_06_06.mat',...
    'results_RCP45_12_Jan_2021_23_11_57.mat',...
    'results_RCP45_12_Jan_2021_23_17_56.mat',...
    'results_RCP45_12_Jan_2021_23_23_07.mat',...
    'results_RCP45_12_Jan_2021_23_28_17.mat',...
    'results_RCP45_12_Jan_2021_23_33_18.mat',...
    'results_RCP45_12_Jan_2021_23_38_23.mat',...
    'results_RCP45_12_Jan_2021_23_43_25.mat',...
    'results_RCP45_12_Jan_2021_23_48_37.mat',...
    'results_RCP45_12_Jan_2021_23_53_38.mat',...
    'results_RCP45_12_Jan_2021_23_58_38.mat',...
    'results_RCP45_13_Jan_2021_00_03_48.mat',...
    'results_RCP45_13_Jan_2021_00_08_52.mat',...
    'results_RCP45_13_Jan_2021_00_13_51.mat',...
    'results_RCP45_13_Jan_2021_00_18_57.mat',...
    'results_RCP45_13_Jan_2021_00_24_02.mat',...
    'results_RCP45_13_Jan_2021_00_29_08.mat',...
    'results_RCP45_13_Jan_2021_00_34_09.mat',...
    'results_RCP45_13_Jan_2021_00_39_13.mat',...
    'results_RCP45_13_Jan_2021_00_44_12.mat',...
    'results_RCP45_13_Jan_2021_00_49_17.mat',...
    'results_RCP45_13_Jan_2021_00_54_18.mat',...
	'results_RCP45_13_Jan_2021_00_59_23.mat',...
    'results_RCP45_13_Jan_2021_01_04_22.mat',...
    'results_RCP45_13_Jan_2021_01_09_24.mat',...
    'results_RCP45_13_Jan_2021_01_14_26.mat',...
    'results_RCP45_13_Jan_2021_01_19_32.mat',...
    'results_RCP45_13_Jan_2021_01_24_35.mat',...
    'results_RCP45_13_Jan_2021_01_29_42.mat',...
    'results_RCP45_13_Jan_2021_01_34_41.mat',...
    'results_RCP45_13_Jan_2021_01_39_45.mat',...
    'results_RCP45_13_Jan_2021_01_44_44.mat',...
    'results_RCP45_13_Jan_2021_01_49_44.mat',...
    'results_RCP45_13_Jan_2021_01_54_41.mat',...
    'results_RCP45_13_Jan_2021_01_59_42.mat',...
    'results_RCP45_13_Jan_2021_02_04_41.mat',...
   'results_RCP45_13_Jan_2021_02_09_43.mat',...
   'results_RCP45_13_Jan_2021_02_14_40.mat',...
   'results_RCP45_13_Jan_2021_02_19_44.mat',...
   'results_RCP45_13_Jan_2021_02_24_46.mat',...
   'results_RCP45_13_Jan_2021_02_34_44.mat',...
   'results_RCP45_13_Jan_2021_02_44_44.mat',...
   'results_RCP45_13_Jan_2021_02_49_46.mat',...
   'results_RCP45_13_Jan_2021_02_54_43.mat',...
   'results_RCP45_13_Jan_2021_02_59_45.mat',...
   'results_RCP45_13_Jan_2021_03_04_42.mat',...
   'results_RCP45_13_Jan_2021_03_09_43.mat',...
   'results_RCP45_13_Jan_2021_03_14_54.mat',...
   'results_RCP45_13_Jan_2021_03_19_54.mat',...
   'results_RCP45_13_Jan_2021_03_24_55.mat',...
   'results_RCP45_13_Jan_2021_03_30_04.mat',...
   'results_RCP45_13_Jan_2021_03_35_05.mat',...
   'results_RCP45_13_Jan_2021_03_40_07.mat',...
   'results_RCP45_13_Jan_2021_03_45_07.mat',...
   'results_RCP45_13_Jan_2021_03_50_08.mat',...
   'results_RCP45_13_Jan_2021_03_55_08.mat',...
   'results_RCP45_13_Jan_2021_04_00_10.mat',...
   'results_RCP45_13_Jan_2021_04_05_07.mat',...
   'results_RCP45_13_Jan_2021_04_10_09.mat',...
   'results_RCP45_13_Jan_2021_04_15_09.mat',...
   'results_RCP45_13_Jan_2021_04_20_16.mat',...
   'results_RCP45_13_Jan_2021_04_25_16.mat',...
   'results_RCP45_13_Jan_2021_04_30_21.mat',...
   'results_RCP45_13_Jan_2021_04_35_20.mat',...
   'results_RCP45_13_Jan_2021_04_40_20.mat',...
   'results_RCP45_13_Jan_2021_04_45_17.mat',...
   'results_RCP45_13_Jan_2021_04_50_21.mat',...
   'results_RCP45_13_Jan_2021_04_55_23.mat',...
   'results_RCP45_13_Jan_2021_05_00_24.mat',...
   'results_RCP45_13_Jan_2021_05_05_23.mat',...
   'results_RCP45_13_Jan_2021_05_10_25.mat',...
   'results_RCP45_13_Jan_2021_05_15_26.mat',...
   'results_RCP45_13_Jan_2021_05_20_28.mat',...
   'results_RCP45_13_Jan_2021_05_25_28.mat',...
   'results_RCP45_13_Jan_2021_05_30_33.mat',...
   'results_RCP45_13_Jan_2021_05_35_34.mat',...
   'results_RCP45_13_Jan_2021_05_40_36.mat',...
   'results_RCP45_13_Jan_2021_05_45_36.mat',...
   'results_RCP45_13_Jan_2021_05_50_40.mat',...
   'results_RCP45_13_Jan_2021_05_55_39.mat',...
   'results_RCP45_13_Jan_2021_06_00_39.mat',...
   'results_RCP45_13_Jan_2021_06_05_37.mat',...
   'results_RCP45_13_Jan_2021_06_10_40.mat',...
   'results_RCP45_13_Jan_2021_06_15_41.mat',...
   'results_RCP45_13_Jan_2021_06_20_43.mat',...
   'results_RCP45_13_Jan_2021_06_25_43.mat',...
   'results_RCP45_13_Jan_2021_06_30_45.mat',...
   'results_RCP45_13_Jan_2021_06_35_44.mat',...
   'results_RCP45_13_Jan_2021_06_40_44.mat',...
   'results_RCP45_13_Jan_2021_06_45_42.mat',...
   'results_RCP45_13_Jan_2021_06_50_42.mat',...
   'results_RCP45_13_Jan_2021_06_55_40.mat',...
   'results_RCP45_13_Jan_2021_07_00_41.mat',...
   'results_RCP45_13_Jan_2021_07_05_40.mat',...
   'results_RCP45_13_Jan_2021_07_10_43.mat',...
   'results_RCP45_13_Jan_2021_07_15_57.mat',...
   'results_RCP45_13_Jan_2021_07_21_43.mat',...
   'results_RCP45_13_Jan_2021_07_26_48.mat',...
   'results_RCP45_13_Jan_2021_07_31_55.mat',...
   'results_RCP45_13_Jan_2021_07_36_56.mat',...
   'results_RCP45_13_Jan_2021_07_41_56.mat',...
   'results_RCP45_13_Jan_2021_07_46_55.mat',...
   'results_RCP45_13_Jan_2021_07_51_54.mat',...
   'results_RCP45_13_Jan_2021_07_56_57.mat',...
   'results_RCP45_13_Jan_2021_08_01_53.mat',...
   'results_RCP45_13_Jan_2021_08_06_53.mat',...
   'results_RCP45_13_Jan_2021_08_11_52.mat',...
   'results_RCP45_13_Jan_2021_08_16_53.mat',...
   'results_RCP45_13_Jan_2021_08_21_52.mat',...
   'results_RCP45_13_Jan_2021_08_26_52.mat',...
   'results_RCP45_13_Jan_2021_08_31_58.mat',...
   'results_RCP45_13_Jan_2021_08_37_03.mat',...
   'results_RCP45_13_Jan_2021_08_42_13.mat',...
   'results_RCP45_13_Jan_2021_08_47_18.mat',...
   'results_RCP45_13_Jan_2021_08_52_26.mat'};
 
% addpath('/Volumes/Ultra Touch/FlexDamProject/Results/RCP45 Results-DamOpt-Jan2');
% dataFlex_RCP45 = {'results_RCP45_02_Jan_2021_22_24_51.mat',...
%     'results_RCP45_02_Jan_2021_22_30_15.mat',...
%     'results_RCP45_02_Jan_2021_22_35_26.mat',...
%     'results_RCP45_02_Jan_2021_22_40_38.mat',...
%     'results_RCP45_02_Jan_2021_22_46_01.mat',...
%     'results_RCP45_02_Jan_2021_22_51_32.mat',...
%     'results_RCP45_02_Jan_2021_22_56_57.mat',...
%     'results_RCP45_02_Jan_2021_23_02_13.mat',...
%     'results_RCP45_02_Jan_2021_23_07_26.mat',...
%     'results_RCP45_02_Jan_2021_23_12_41.mat',...
%     'results_RCP45_02_Jan_2021_23_17_54.mat',...
%     'results_RCP45_02_Jan_2021_23_23_04.mat',...
%     'results_RCP45_02_Jan_2021_23_28_16.mat',...
%     'results_RCP45_02_Jan_2021_23_33_28.mat',...
%     'results_RCP45_02_Jan_2021_23_38_37.mat',...
%     'results_RCP45_02_Jan_2021_23_43_46.mat',...
%     'results_RCP45_02_Jan_2021_23_49_00.mat',...
%     'results_RCP45_02_Jan_2021_23_54_11.mat',...
%     'results_RCP45_02_Jan_2021_23_59_25.mat',...
%     'results_RCP45_03_Jan_2021_00_04_38.mat',...
%     'results_RCP45_03_Jan_2021_00_09_53.mat',...
%     'results_RCP45_03_Jan_2021_00_15_05.mat',...
%     'results_RCP45_03_Jan_2021_00_20_18.mat',...
%     'results_RCP45_03_Jan_2021_00_25_32.mat',...
%     'results_RCP45_03_Jan_2021_00_30_44.mat',...
%     'results_RCP45_03_Jan_2021_00_35_57.mat',...
%     'results_RCP45_03_Jan_2021_00_41_11.mat',...
%     'results_RCP45_03_Jan_2021_00_46_25.mat',...
%     'results_RCP45_03_Jan_2021_00_51_36.mat',...
%     'results_RCP45_03_Jan_2021_00_56_48.mat',...
%     'results_RCP45_03_Jan_2021_01_02_00.mat',...
%     'results_RCP45_03_Jan_2021_01_07_14.mat',...
%     'results_RCP45_03_Jan_2021_01_12_27.mat',...
%     'results_RCP45_03_Jan_2021_01_17_41.mat',...
%     'results_RCP45_03_Jan_2021_01_22_55.mat',...
%     'results_RCP45_03_Jan_2021_01_28_06.mat',...
%     'results_RCP45_03_Jan_2021_01_33_17.mat',...
%     'results_RCP45_03_Jan_2021_01_38_29.mat',...
%     'results_RCP45_03_Jan_2021_01_43_43.mat',...
%     'results_RCP45_03_Jan_2021_01_48_57.mat',...
%     'results_RCP45_03_Jan_2021_01_54_11.mat',...
%     'results_RCP45_03_Jan_2021_01_59_25.mat',...
%     'results_RCP45_03_Jan_2021_02_04_36.mat',...
%     'results_RCP45_03_Jan_2021_02_09_48.mat',...
%     'results_RCP45_03_Jan_2021_02_15_02.mat',...
%     'results_RCP45_03_Jan_2021_02_20_14.mat',...
%     'results_RCP45_03_Jan_2021_02_25_27.mat',...
%     'results_RCP45_03_Jan_2021_02_30_37.mat',...
%     'results_RCP45_03_Jan_2021_02_35_56.mat',...
%     'results_RCP45_03_Jan_2021_02_41_07.mat'};

for g=1:length(dataFlex_RCP45)
    load(dataFlex_RCP45{g});
    storFlex(g,1) = storage(1);
    storFlex(g,2) = storage(2);
    totalCostFlex(:,:,g) = squeeze(sum(totalCostTime(:,:,1:3), 2));
 
end

for g=1:length(dataFlex_RCP45)
    medCostFlex(g) = median(sum(totalCostFlex(:,3,g), 2));
    meanCostFlex(g) = mean(sum(totalCostFlex(:,3,g), 2)); 
    perc50(g) = prctile(totalCostFlex(:,3,g),50);
    perc75(g) = prctile(totalCostFlex(:,3,g),75);
    perc90(g) = prctile(totalCostFlex(:,3,g),90);
end
    
%% plot data- RCP4.5- median and mean

% put data into one variable
comboFlex(:,1) = storFlex(:,1);
comboFlex(:,2) = storFlex(:,2);
comboFlex(:,3) = medCostFlex(:)';
comboFlex(:,4) = meanCostFlex(:)';
comboFlex(:,5) = perc75(:)';
comboFlex(:,6) = perc90(:)';

% create scatter with med and mean cost data
f = figure('Position', [57 254 1115 430]);
subplot(1,2,1)
scatter(comboFlex(:,1), comboFlex(:,2), [], comboFlex(:,5)/1000000, 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
xticks([70:5:90]);
title('75th perc Dam Cost (M$)');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',comboFlex(:,5)/1000000))

subplot(1,2,2)
scatter(comboFlex(:,1), comboFlex(:,2), [], comboFlex(:,6)/1000000, 'filled')
c = colorbar;
c.Position = c.Position + [0.08 -0.02 0 0];
xlabel('Small Dam Size (MCM)');
%ylabel('Large Dam Size (MCM)');
xticks([70:5:90]);
title('90th perc Dam Cost (M$)');
colormap(jet);
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',comboFlex(:,6)/1000000))
sgtitle('RCP4.5 Flexible Dam Median and Mean Costs');

%% Look at various percentiles- RCP4.5 flex

Cost_p_RCP45 = squeeze(prctile(totalCostFlex(:,3,:),[10 25 75 90]))';

%f = figure('Position', [57 254 1115 430]);
subplot(2,2,1)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP45(:,1)/1000000, 'filled')
colorbar;
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
colormap(jet);
title('10th Percentile Dam Cost (M$)');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP45(:,1)/1000000))

subplot(2,2,2)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP45(:,2)/1000000, 'filled')
colorbar;
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
title('25th Percentile Dam Cost (M$)');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP45(:,2)/1000000))

subplot(2,2,3)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP45(:,3)/1000000, 'filled')
colorbar;
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
title('75th Percentile Dam Cost (M$)');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP45(:,3)/1000000))

subplot(2,2,4)
scatter(comboFlex(:,1), comboFlex(:,2), [], Cost_p_RCP45(:,4)/1000000, 'filled')
colorbar;
xlabel('Small Dam Size (MCM)');
ylabel('Large Dam Size (MCM)');
title('90th Percentile Dam Cost (M$)');
text(comboFlex(:,1), comboFlex(:,2), compose('$%.3gM',Cost_p_RCP45(:,4)/1000000))

%% try making boxplot of flex options
% make a subplot with the large dam sizes for each small dam size

comboFlex_struct = array2table(comboFlex, 'VariableNames', {'Small', 'Large', 'Median', 'Mean'});

for g=1:61
    comboFlex_struct(g,5) = {storFlex(g,:)};
end

smallDam = min(comboFlex(:,1));
smallDamMax = max(comboFlex(:,1));
y = 1;
% while loop to create boxplot for each small dam size
while smallDam <= smallDamMax
    % put appropriate data in a table
    
    % plot subplot
    
end